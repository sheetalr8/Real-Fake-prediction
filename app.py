# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1x-Vn5OBQqG92S1SbgDjDmGRhwZtgjhqf
"""

import sys
!{sys.executable} -m pip install streamlit
import streamlit as st
import pandas as pd
import numpy as np
import string
import re
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split

st.set_page_config(page_title="Fake News Detector", layout="centered")

st.title("üì∞ Fake News Detection App")
st.write("Enter a news article below and check whether it is Real or Fake.")

# -----------------------------
# Load Dataset
# -----------------------------
@st.cache_data
def load_data():
    df = pd.read_csv("/content/Fake_Real_Data(in).csv", engine='python')
    return df

df = load_data()

# -----------------------------
# Text Cleaning Function
# -----------------------------
def clean_text(text):
    text = text.lower()
    text = re.sub(r'\[.*?\]', '', text)
    text = re.sub(r'http\S+', '', text)
    text = re.sub(r'<.*?>+', '', text)
    text = re.sub(r'[%s]' % re.escape(string.punctuation), '', text)
    text = re.sub(r'\n', '', text)
    text = re.sub(r'\w*\d\w*', '', text)
    return text

df['Text'] = df['Text'].apply(clean_text)

# -----------------------------
# Train Model
# -----------------------------
@st.cache_resource
def train_model():

    X = df['Text']
    y = df['label']   # Make sure column name is 'label'

    vectorizer = TfidfVectorizer(max_features=5000)
    X_vectorized = vectorizer.fit_transform(X)

    model = LogisticRegression()
    model.fit(X_vectorized, y)

    return model, vectorizer

model, vectorizer = train_model()

# -----------------------------
# User Input Section
# -----------------------------
user_input = st.text_area("‚úçÔ∏è Enter News Text Here:")

if st.button("Predict"):

    cleaned_input = clean_text(user_input)
    input_vector = vectorizer.transform([cleaned_input])

    prediction = model.predict(input_vector)[0]
    probability = model.predict_proba(input_vector)[0]

    fake_prob = round(probability[0] * 100, 2)
    real_prob = round(probability[1] * 100, 2)

    if prediction == 1:
        st.success(f"‚úÖ This News is REAL")
    else:
        st.error(f"üö® This News is FAKE")

    st.write(f"Fake Probability: {fake_prob}%")
    st.write(f"Real Probability: {real_prob}%")

